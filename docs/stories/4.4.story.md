# Story 4.4: Business Ad & Promotion Management

**Status:** Draft

## Story Statement
As a business owner,
I want to show my ads and publish promotions in the app,
so that I can increase visibility and reach.

## Acceptance Criteria
- Business owner can create and manage promotional banners (ad_type 'banner').
- Business owner can manage their storefront (including offers and promotions) on the go.
- Business owner pays a cost for displaying ads (currently â‚¹500/banner/day), managed on a postpaid billing basis following the Google Ads model.
- Ads and Promotions tables are populated with business_id, title, description, target_parameters, start_date, end_date. Ads table also includes ad_type, image_url, cost_per_day.
- Local Testability: API endpoint POST /api/business/ads creates an ad, returning 201 Created. Verification by querying SELECT * FROM public.Ads WHERE business_id = '{business_id}' AND title = '{ad_title}'.

## Dev Notes
### Previous Story Insights
- Business analytics and targeted coupon issuance are in place. [Source: docs/stories/4.2.story.md, docs/stories/4.3.story.md]

### Data Models
- Ads table: business_id, title, description, target_parameters, start_date, end_date, ad_type, image_url, cost_per_day. [Source: PRD]
- Promotions table: business_id, title, description, target_parameters, start_date, end_date. [Source: PRD]

### API Specifications
- POST /api/business/ads: Creates a new ad. [Source: PRD]
- POST /api/business/promotions: Creates a new promotion. [Source: PRD]
- All API interactions must go through frontend API service layer (`apps/web/src/api/`). [Source: architecture/coding-standards.md]

### Component Specifications
- Ad and promotion management UI: Create, edit, and manage banners, offers, and promotions. [Source: PRD]
- Storefront management UI for offers and promotions. [Source: PRD]
- Payment handling for ad banners (postpaid, Google Ads model). [Source: PRD]

### File Locations
- Frontend pages: `apps/web/src/pages/business-ads.tsx`, `apps/web/src/pages/business-promotions.tsx`
- API service: `apps/web/src/api/ads.ts`, `apps/web/src/api/promotions.ts`
- Backend: `apps/api/src/business/` (serverless functions for ads and promotions)
[Source: architecture/unified-project-structure.md]

### Testing Requirements
- Frontend: Unit and integration tests for ad and promotion management UI. [Source: architecture/testing-strategy.md]
- Backend: Unit and integration tests for ads and promotions endpoints. [Source: architecture/testing-strategy.md]
- E2E: Playwright/Cypress tests for ad and promotion management flows. [Source: architecture/testing-strategy.md]

### Technical Constraints
- TypeScript for all codebases. [Source: architecture/tech-stack.md]
- Follow coding standards for API service layer, error handling, and naming conventions. [Source: architecture/coding-standards.md]
- State management for ads/promotions via React Context API/Zustand/Jotai. [Source: architecture/tech-stack.md]
- Payment handling must follow Google Ads postpaid model. [Source: PRD]

## Tasks / Subtasks
1. Implement ad and promotion management UI for business owners. [Source: PRD]
2. Implement backend endpoints for ad and promotion creation/management. [Source: PRD]
3. Store and retrieve ad and promotion data in Ads and Promotions tables. [Source: PRD]
4. Implement payment handling for ad banners (postpaid, Google Ads model). [Source: PRD]
5. Add validation and error handling for ad and promotion management. [Source: architecture/coding-standards.md]
6. Write unit/integration tests for frontend ad and promotion management UI. [Source: architecture/testing-strategy.md]
7. Write unit/integration tests for backend ads and promotions endpoints. [Source: architecture/testing-strategy.md]
8. Write E2E tests for ad and promotion management flows. [Source: architecture/testing-strategy.md]
9. Verify all file locations and naming conventions match unified project structure. [Source: architecture/unified-project-structure.md]

## Project Structure Notes
- All files should be placed according to the unified project structure. [Source: architecture/unified-project-structure.md]
- No conflicts found between epic requirements and unified project structure.

---

Checklist: To be completed after draft review.
- [ ] All acceptance criteria addressed
- [ ] All technical context referenced
- [ ] Tasks/subtasks are actionable and referenced
- [ ] Project structure alignment verified
- [ ] Ready for developer implementation 