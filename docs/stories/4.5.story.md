# Story 4.5: Platform Owner Dashboard & Core Revenue Tracking

**Status:** Approved

## Story Statement
As a Platform Owner,
I want a holistic view of platform activities and to track revenue from core monetization streams,
so that I can manage the platform and its financial performance.

## Acceptance Criteria
- Platform owner can access a dedicated dashboard with a holistic view of all activities across all modules.
- Dashboard displays advanced tracing of revenue from coupon generation.
- Dashboard displays advanced tracing of revenue from promotional banners.
- Dashboard displays advanced tracing of revenue from showing ads in search results.
- Dashboard displays advanced tracing of revenue from push notifications.
- The dashboard provides revenue metrics such as weekly, monthly, quarterly, and seasonal reports.
- RevenueTracking table accurately records source_type, associated_entity_id, business_id, amount, and transaction_date for each revenue event.
- Local Testability: API endpoint GET /api/platform/revenue returns aggregated revenue data. Verification by inspecting the returned JSON for correct revenue breakdowns (e.g., {"coupon_revenue": 10000, "ad_revenue": 5000}).

## Dev Notes
### Previous Story Insights
- Business analytics, ad management, and monetization features are in place. [Source: docs/stories/4.1.story.md - 4.4.story.md]

### Data Models
- RevenueTracking table: source_type, associated_entity_id, business_id, amount, transaction_date. [Source: PRD]

### API Specifications
- GET /api/platform/revenue: Returns aggregated revenue data. [Source: PRD]
- All API interactions must go through frontend API service layer (`apps/web/src/api/`). [Source: architecture/coding-standards.md]

### Component Specifications
- Platform owner dashboard UI: Revenue metrics, breakdowns by source, time period selectors, activity summaries. [Source: PRD]

### File Locations
- Frontend pages: `apps/web/src/pages/platform-owner-dashboard.tsx`
- API service: `apps/web/src/api/platform-revenue.ts`
- Backend: `apps/api/src/platform/` (serverless functions for revenue tracking)
[Source: architecture/unified-project-structure.md]

### Testing Requirements
- Frontend: Unit and integration tests for platform owner dashboard UI. [Source: architecture/testing-strategy.md]
- Backend: Unit and integration tests for revenue tracking endpoints. [Source: architecture/testing-strategy.md]
- E2E: Playwright/Cypress tests for revenue dashboard flows. [Source: architecture/testing-strategy.md]

### Technical Constraints
- TypeScript for all codebases. [Source: architecture/tech-stack.md]
- Follow coding standards for API service layer, error handling, and naming conventions. [Source: architecture/coding-standards.md]
- State management for revenue dashboard via React Context API/Zustand/Jotai. [Source: architecture/tech-stack.md]
- Revenue calculations must be efficient and scalable. [Source: PRD]

## Tasks / Subtasks
1. Implement platform owner dashboard UI for revenue and activity metrics. [Source: PRD]
2. Implement backend endpoint for aggregated revenue data. [Source: PRD]
3. Store and retrieve revenue data in RevenueTracking table. [Source: PRD]
4. Add time period selectors and breakdowns by source. [Source: PRD]
5. Add validation and error handling for revenue data. [Source: architecture/coding-standards.md]
6. Write unit/integration tests for frontend revenue dashboard. [Source: architecture/testing-strategy.md]
7. Write unit/integration tests for backend revenue endpoints. [Source: architecture/testing-strategy.md]
8. Write E2E tests for revenue dashboard flows. [Source: architecture/testing-strategy.md]
9. Verify all file locations and naming conventions match unified project structure. [Source: architecture/unified-project-structure.md]

## Project Structure Notes
- All files should be placed according to the unified project structure. [Source: architecture/unified-project-structure.md]
- No conflicts found between epic requirements and unified project structure.

---

Checklist: To be completed after draft review.
- [ ] All acceptance criteria addressed
- [ ] All technical context referenced
- [ ] Tasks/subtasks are actionable and referenced
- [ ] Project structure alignment verified
- [ ] Ready for developer implementation 