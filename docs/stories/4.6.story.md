# Story 4.6: Platform Owner Business Management & Pricing Configuration

**Status:** Draft

## Story Statement
As a Platform Owner,
I want to manage business visibility and configure pricing,
so that I can maintain platform quality and control monetization.

## Acceptance Criteria
- Platform owner can change the visibility status of any business (e.g., hide from search results).
- Platform owner can block spammy businesses from the platform.
- Platform owner can configure variable rates for features used, including coupon generation (₹2/coupon), ad banners (₹500/banner/day), and first place in search results (₹500/day).
- Platform owner can set and modify pricing for any other future monetization elements as needed.
- PlatformConfig table stores configurable pricing key_name and config_value (JSONB).
- PlatformOwnerActivities table records actions like change_business_visibility, block_spam, and update_pricing.
- Local Testability: API endpoint PUT /api/platform/config/pricing updates pricing configuration. Verification by querying SELECT config_value FROM public.PlatformConfig WHERE key_name = 'pricing_rates'.

## Dev Notes
### Previous Story Insights
- Platform owner dashboard and revenue tracking are in place. [Source: docs/stories/4.5.story.md]

### Data Models
- PlatformConfig table: key_name, config_value (JSONB). [Source: PRD]
- PlatformOwnerActivities table: action_type, business_id, details, timestamp. [Source: PRD]

### API Specifications
- PUT /api/platform/config/pricing: Updates pricing configuration. [Source: PRD]
- PUT /api/platform/business/{business_id}/visibility: Changes business visibility. [Source: PRD]
- PUT /api/platform/business/{business_id}/block: Blocks a business. [Source: PRD]
- All API interactions must go through frontend API service layer (`apps/web/src/api/`). [Source: architecture/coding-standards.md]

### Component Specifications
- Business management UI: Change visibility, block businesses, view business list. [Source: PRD]
- Pricing configuration UI: Set/modify rates for features. [Source: PRD]
- Activity log UI for platform owner actions. [Source: PRD]

### File Locations
- Frontend pages: `apps/web/src/pages/platform-business-management.tsx`, `apps/web/src/pages/platform-pricing-config.tsx`
- API service: `apps/web/src/api/platform-business.ts`, `apps/web/src/api/platform-pricing.ts`
- Backend: `apps/api/src/platform/` (serverless functions for business management and pricing)
[Source: architecture/unified-project-structure.md]

### Testing Requirements
- Frontend: Unit and integration tests for business management and pricing UI. [Source: architecture/testing-strategy.md]
- Backend: Unit and integration tests for business management and pricing endpoints. [Source: architecture/testing-strategy.md]
- E2E: Playwright/Cypress tests for business management and pricing flows. [Source: architecture/testing-strategy.md]

### Technical Constraints
- TypeScript for all codebases. [Source: architecture/tech-stack.md]
- Follow coding standards for API service layer, error handling, and naming conventions. [Source: architecture/coding-standards.md]
- State management for business management/pricing via React Context API/Zustand/Jotai. [Source: architecture/tech-stack.md]
- Pricing configuration must be flexible and secure. [Source: PRD]

## Tasks / Subtasks
1. Implement business management UI for platform owner (visibility, block, list). [Source: PRD]
2. Implement pricing configuration UI for setting/modifying rates. [Source: PRD]
3. Implement backend endpoints for business management and pricing configuration. [Source: PRD]
4. Store and retrieve pricing and business management data in PlatformConfig and PlatformOwnerActivities tables. [Source: PRD]
5. Add activity log UI for platform owner actions. [Source: PRD]
6. Add validation and error handling for business management and pricing actions. [Source: architecture/coding-standards.md]
7. Write unit/integration tests for frontend business management and pricing UI. [Source: architecture/testing-strategy.md]
8. Write unit/integration tests for backend business management and pricing endpoints. [Source: architecture/testing-strategy.md]
9. Write E2E tests for business management and pricing flows. [Source: architecture/testing-strategy.md]
10. Verify all file locations and naming conventions match unified project structure. [Source: architecture/unified-project-structure.md]

## Project Structure Notes
- All files should be placed according to the unified project structure. [Source: architecture/unified-project-structure.md]
- No conflicts found between epic requirements and unified project structure.

---

Checklist: To be completed after draft review.
- [ ] All acceptance criteria addressed
- [ ] All technical context referenced
- [ ] Tasks/subtasks are actionable and referenced
- [ ] Project structure alignment verified
- [ ] Ready for developer implementation 